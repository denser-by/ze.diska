package mydev.rcv; import java.io.FileOutputStream; import java.io.InputStream; import java.io.OutputStream; import java.net.ServerSocket; import java.net.Socket; public class MyIpRcv { static final String FILE_NAME="files.tree"; static int rcvPort=6012; static String ftPath=null; public static void main(String[] args) { for(int i=0; i < args.length; i++) { String e=args[i]; if(e.indexOf("MyIpRcv") >= 0) continue; int port=-1; try { port=Integer.parseInt(e);} catch(Throwable th) { th.getMessage(); port=-1;} finally { if(port > 0) rcvPort=port;}} Socket e1; ServerSocket a1; long total=0L; InputStream os; OutputStream is; int em,num; byte[] buf; try { a1=new ServerSocket(rcvPort); System.out.println(""+a1+" "+a1.getInetAddress()); e1=a1.accept(); System.out.println(""+e1+" "+e1.getInetAddress()); os=e1.getInputStream(); is=null; if(os !=null) { do { buf=new byte[8192]; num=os.read(buf); if(num > 0) { if(is==null && num > 1) is=new FileOutputStream(ftPath !=null ? ftPath : FILE_NAME); if(is !=null) { if(num==buf.length) is.write(buf); else { for(int i=0; i < num; i++) is.write(buf[i]);}} total+=num;}} while(num > 0); is.close(); System.out.println(""+total+" bytes received");} os.close(); a1.close(); e1.close();} catch(Throwable ex1) { System.out.println("ER:"+ex1.getMessage());} System.out.println("Hello Wind World!");}}
