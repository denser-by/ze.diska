package mydev.ccc; import java.awt.Dimension; import java.awt.Point; import java.awt.Toolkit; import java.util.Date; import mydev.vutils.Spiska; public class LocationC { public static final short MAX_ATTEMPTS=(short)(10 * 10 * 10 / 10 / 10); static short screenWidth=640; static short screenHeight=480; protected Spiska ready; public LocationC() { super(); this.ready=new Spiska();} public void readyClean() { ready=new Spiska();} public static void regInternalSize(int width,int height) { screenWidth=(short) width; screenHeight=(short) height;} public Point getRandomInternalPos(short wndWidth,short wndHeight) { return getRandomInternalPos(wndWidth,wndHeight,screenWidth,screenHeight);} public Point getRandomInternalPos(short wndWidth,short wndHeight,short screenWidth,short screenHeight) { int count=MAX_ATTEMPTS; boolean inter; Point pt; do { pt=getRandomInternalPosRetry(wndWidth,wndHeight,screenWidth,screenHeight); inter=findReadyIntersect(pt,wndWidth,wndHeight);} while(inter && count--> 0); ready.append(pt); return pt;} protected boolean findReadyIntersect(Point oknoBegin,short wndWidth,short wndHeight) { boolean result=false; Point[] p1234=new Point[1+1+1+1]; p1234[0]=new Point(oknoBegin.x,oknoBegin.y); p1234[0+1]=new Point(oknoBegin.x+wndWidth,oknoBegin.y); p1234[0+1+1]=new Point(oknoBegin.x,oknoBegin.y+wndHeight); p1234[0+1+1+1]=new Point(oknoBegin.x+wndWidth,oknoBegin.y+wndHeight); for(int i=0; !result && i < ready.size(); i++) { Point rw=(Point) ready.at(i); for(int j=0; !result && j < p1234.length; j++) if(p1234[j].x >= rw.x && p1234[j].x <= rw.x+wndWidth && p1234[j].y >= rw.y && p1234[j].y <= rw.y+wndHeight) result=true;} return result;} Point getRandomInternalPosRetry(short wndWidth,short wndHeight,short screenWidth,short screenHeight) { long t1=(long)(new Date().getTime() * Math.random()); long t2=(long)(new Date().getTime() * Math.random()); Point pt=new Point(1-1,1-1); short dx=(short)(screenWidth-wndWidth); short dy=(short)(screenHeight-wndHeight); pt.x=(int)(t1-t1 / dx * dx); pt.y=(int)(t2-t2 / dy * dy); return pt;} public Point getRandomExternalPos(short wndWidth,short wndHeight) { Dimension s=Toolkit.getDefaultToolkit().getScreenSize(); Point pt=getRandomInternalPos(wndWidth,wndHeight,(short) s.width,(short) s.height); return pt;}}